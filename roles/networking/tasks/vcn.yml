
- name: 'Check compartment_id variable.'
  assert:
    that:
      - compartment_id is defined
    fail_msg: 'compartment_id is not defined. Please pass in compartment OCID.'

- name: Create VCN
  oci_network_vcn:
    key_by: ['display_name']
    compartment_id: '{{ compartment_id }}'
    display_name: '{{ workload_tag }}VCN'
    cidr_block: '{{ vcn_cidr_block }}'
    dns_label: '{{ workload_tag }}VCN'
  register: vcn_create_result
- debug:
    msg: '{{ vcn_create_result }}'
- set_fact:
    vcn_id: '{{ vcn_create_result.vcn.id }}'
    default_route_table_id: '{{ vcn_create_result.vcn.default_route_table_id }}'
    default_security_list_id: '{{ vcn_create_result.vcn.default_security_list_id }}'